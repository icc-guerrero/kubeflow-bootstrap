# Namespaces to be created
namespaces:
  project: unicc-aihub
  certManager: cert-manager
  istioSystem: istio-system
  knative: knative-serving
  kubeflow: kubeflow
  oauth2proxy: oauth2-proxy
  auth: auth

# Official kubeflow manifests repo and tag to use
kubeflow:
  manifestsRepo: https://github.com/kubeflow/manifests
  refTag: v1.10.1

# Enable or disable components
enable:
  certManager: true
  istio: true
  knative: true
  kserve: true
  dex: true
  centralDashboard: true
  pipelines: true
  notebooks: true
  profiles: true
  trainingOperator: true

oauth2Proxy:
  enabled: true
  # m2m-dex-only | m2m-dex-and-kind | m2m-dex-and-eks
  overlay: m2m-dex-only
  cookieDomains:
    - "example.com"
  whitelistDomains:
    - "example.com"
dex:
  logLevel: "debug"  # debug, info, warn, error
  skipApprovalScreen: true
  enablePasswordDB: true
  staticPasswords:
    - email: "user@example.com"
      hashFromEnv: "DEX_USER_PASSWORD"
      username: "user"
      userID: "15841185641784"
  # Microsoft Azure AD B2C Connector Configuration (using OIDC)
  connectors:
    - type: oidc
      id: azure-b2c
      name: Microsoft Azure AD B2C
      config:
        # Use the OIDC Discovery endpoint you have (paste the full URL here)
        # Example: https://<tenant-name>.b2clogin.com/<tenant-id>/<custom-policy>/v2.0/
        issuer: "PASTE_YOUR_OIDC_DISCOVERY_URL_HERE"
        # Paste your Client ID
        clientID: "PASTE_YOUR_CLIENT_ID_HERE"
        # Paste your Secret Value (not the Secret ID)
        clientSecret: "PASTE_YOUR_SECRET_VALUE_HERE"
        # Redirect URI - must match what's configured in Azure AD B2C
        redirectURI: "https://sandbox.ai.unicc.org/dex/callback"
        # Scopes to request (openid is required, add profile, email, etc.)
        scopes:
          - openid
          - profile
          - email
        # Optional: Customize claim mappings
        userIDKey: oid  # Use Azure's oid (object ID) as unique identifier
        userNameKey: preferred_username  # Or 'email' or 'name'
        # Optional: Get user info from userinfo endpoint
        getUserInfo: true
# Timings
kustomizations:
  intervals:
    default: 5m
  timeouts:
    short: 5m
    medium: 10m
    long: 15m
